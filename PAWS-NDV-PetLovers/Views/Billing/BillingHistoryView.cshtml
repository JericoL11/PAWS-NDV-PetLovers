@model PAWS_NDV_PetLovers.ViewModels.TransactionsVm
@{
    ViewData["Title"] = "Billing History View";
}
<div class="bg-secondary bg-opacity-10 mb-3 py-2">
    <div class="container">
        <h3>Billing Information</h3>
    </div>
</div>

<div class="container">
  
    <div>
        @if (Model.Billing.purchase == null)
        {
            var custmerName = $"{Model.Billing.diagnostics.pet.owner.fname} {Model.Billing.diagnostics.pet.owner.lname}";
            <span><strong> Customer Name: </strong>@custmerName  &nbsp;  &nbsp; &nbsp;</span>
             <strong>Date:</strong> <span>@Model.Billing.date.ToString("MMM. dd, yyyy")</span>
        }
        else
        {
            <span><strong> Customer Name: </strong>@Model.Billing.purchase.customerName  &nbsp;  &nbsp; &nbsp;</span>
            <strong>Date:</strong> <span>@Model.Billing.date.ToString("MMM. dd, yyyy")</span>
        }

    </div>

   <table class="table">
       @* diagnostic *@
       <thead>
           <tr>
               <th></th>
               <th>Price</th>
               <th>Quantity</th>
           </tr>
       </thead>
       <tbody>
           <div class="mt-3">
                  @if (Model.Billing.diagnostics != null)
                { 
                    <th>Service</th>
          
                    @foreach(var service in Model.Billing.diagnostics.IdiagnosticDetails)
                    {
                        <tr>
                            <td>@Html.DisplayFor(s => service.Services.serviceName)</td>
                            <td>@Html.DisplayFor(s => service.Services.serviceCharge)</td>
                        </tr>
                    }
                }
  
            </div>

              @* Purchase *@
           
            <div class="my-3">
                  @if (Model.Billing.purchase != null)
                  {
                     <th>Purchase</th>
                         
                    @foreach (var purchase in Model.Billing.purchase.purchaseDetails)
                    {
                        <tr>
                            <td>@Html.DisplayFor(s => purchase.product.productName)</td>
                            <td>@Html.DisplayFor(s => purchase.product.sellingPrice)</td>
                            <td>@Html.DisplayFor(s => purchase.quantity)</td>
                        </tr>
                    }
                }
            </div>
              
    
       </tbody>
   </table>
   <div class="mt-5">
        @{
            var total = @Model.Billing.grandTotal;
            var grandTotal = (double)total;

             var cash = @Model.Billing.cashReceive;
            var tendered = (double)cash;

             var change = @Model.Billing.changeAmount;
            var totalChange = (double)change;

        }
        <strong>Grand Total : <span class="text-danger fw-bold">@grandTotal.ToString("C")</span></strong> <br />
        <strong>Cash Tendered : <span class=" fw-bold">@tendered.ToString("C")</span></strong><br />
        <strong>Change : <span class=" fw-bold">@totalChange.ToString("C")</span></strong>
   </div>

   
       <div class="mt-3">
           <a asp-action="BillingHistory" class="btn btn-secondary">Back to History</a>
       </diV>     
</div>
        